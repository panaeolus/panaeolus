giDrone ftgen 0, 0, 256, 9,  1,1,0,   1.732050807568877,.5773502691896259,0,   2.449489742783178,.408248290463863,0,   3.162277660168379,.3162277660168379,0,   3.872983346207417,.2581988897471611,0,   4.58257569495584,.2182178902359924,0,   5.291502622129182,.1889822365046136,0, 6,.1666666666666667,0,   6.70820393249937,.1490711984999859,0,   7.416198487095663,.1348399724926484,0,   8.124038404635961,.1230914909793327,0,   9.539392014169456,.1048284836721918,0,  10.2469507659596,.0975900072948533,0,  10.95445115010332,.0912870929175277,0,   11.6619037896906,.0857492925712544,0

giHammer1 ftgen 0, 0, 128, 21, 6, 5.745
giHammer2 ftgen 0, 0, 128, 13, 1, 1, 0, 0, 0, -.1, 0, .3, 0, -.5, 0, .7, 0, -.9, 0, 1, 0, -1, 0
giHammerMass ftgen 0, 0, 256, -7, 1, 128, 1
giHammerStiff ftgen 0, 0, 256, -7, 50, 64, 100, 64, 0
giHammerDamp ftgen 0, 0, 256, -7, 1, 128, 1
giHammerVel ftgen 0, 0, 256, -7, 0, 128, 0

instr 1
  iamp = ampdb(p5 - 10)
  kfreq = cpsmidinn(p4)
  a1 scantable iamp, kfreq, giDrone, giHammerMass, giHammerStiff, giHammerDamp, giHammerVel
  if p3 < 0 then
    kenv linsegr 1, .05, 0.5, 5, 0
    asig = a1 * kenv
  else
    asig linenr a1/3,0.01,p3/2,0.1
  endif
  outs asig, asig
endin
